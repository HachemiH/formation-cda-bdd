# 2.4 Modèle Physique des Données (MPD) pour PostgreSQL

<blockquote>
    <h2>Prérequis</h2>
    <p>Avoir une compréhension solide du Modèle Logique des Données (MLD) et être familiarisé avec l'exemple de la pizzeria.</p>
</blockquote>

<blockquote>
    <h2>Objectifs pédagogiques</h2>
    <ul>
        <li>Adapter le MLD au MPD spécifique pour PostgreSQL, en mettant l'accent sur les fonctionnalités et les contraintes propres à ce SGBD.</li>
        <li>Approfondir la compréhension de l'intégrité fonctionnelle et physique dans le contexte du MPD.</li>
        <li>Démontrer l'implémentation des structures de données, des contraintes et des types de données PostgreSQL à travers l'exemple de la pizzeria.</li>
    </ul>
</blockquote>

## 2.4.1 Spécificités du MPD pour PostgreSQL

Dans le processus de création d'un MPD pour PostgreSQL, nous allons au-delà de la simple transformation des entités en tables. Nous exploitons les fonctionnalités avancées de PostgreSQL pour optimiser la structure de données et renforcer l'intégrité des données.

### Contraintes et Index

Le MPD intègre des contraintes d'intégrité fonctionnelle et physique à travers l'utilisation de contraintes `CHECK`, `UNIQUE`, et `NOT NULL`. De plus, l'utilisation d'index sur les clés étrangères et d'autres colonnes fréquemment consultées ou impliquées dans des jointures améliore considérablement les performances des requêtes.


## 2.4.2 Application de l'Intégrité Fonctionnelle et Physique

L'accent est mis sur l'application pratique de l'intégrité fonctionnelle à travers des mécanismes comme les triggers PostgreSQL, qui peuvent exécuter automatiquement des vérifications ou des corrections de données selon des règles métier spécifiques.

L'intégrité physique est assurée par une conception rigoureuse des clés et des contraintes, avec une attention particulière portée aux types de données et à la manière dont ils influencent le stockage et l'accès aux données.

## 2.4.3 Exemple de Mise en Œuvre pour la Pizzeria

L'exemple de la pizzeria est concrètement mis en œuvre dans PostgreSQL, illustrant la création de tables, l'attribution de types de données appropriés, la définition de contraintes pour refléter l'intégrité fonctionnelle et physique, et l'optimisation des performances par exemple à travers l'utilisation d'index.

```sql

-- Table Client
CREATE TABLE Client (
    ID_Client SERIAL PRIMARY KEY,
    Nom VARCHAR(255) NOT NULL,
    Adresse VARCHAR(255) NOT NULL
);

-- Table Commande
CREATE TABLE Commande (
    ID_Commande SERIAL PRIMARY KEY,
    ID_Client INT NOT NULL,
    Date DATE NOT NULL,
    Montant_Total DECIMAL(10,2) NOT NULL,
    CONSTRAINT fk_commande_client FOREIGN KEY (ID_Client)
    REFERENCES Client (ID_Client)
);

-- Table Pizza
CREATE TABLE Pizza (
    ID_Pizza SERIAL PRIMARY KEY,
    Nom VARCHAR(255) NOT NULL,
    Prix DECIMAL(5,2) NOT NULL
);

-- Table Ingrédient
CREATE TABLE Ingredient (
    ID_Ingredient SERIAL PRIMARY KEY,
    Nom VARCHAR(255) NOT NULL,
    Quantite_en_stock INT NOT NULL
);

-- Table d'association CommandePizza
CREATE TABLE CommandePizza (
    ID_Commande INT NOT NULL,
    ID_Pizza INT NOT NULL,
    Quantite INT NOT NULL CHECK (Quantite > 0),
    PRIMARY KEY (ID_Commande, ID_Pizza),
    CONSTRAINT fk_commandepizza_commande FOREIGN KEY (ID_Commande)
    REFERENCES Commande (ID_Commande),
    CONSTRAINT fk_commandepizza_pizza FOREIGN KEY (ID_Pizza)
    REFERENCES Pizza (ID_Pizza)
);

-- Table d'association PizzaIngredient
CREATE TABLE PizzaIngredient (
    ID_Pizza INT NOT NULL,
    ID_Ingredient INT NOT NULL,
    Quantite INT NOT NULL CHECK (Quantite > 0),
    PRIMARY KEY (ID_Pizza, ID_Ingredient),
    CONSTRAINT fk_pizzaingredient_pizza FOREIGN KEY (ID_Pizza)
    REFERENCES Pizza (ID_Pizza),
    CONSTRAINT fk_pizzaingredient_ingredient FOREIGN KEY (ID_Ingredient)
    REFERENCES Ingredient (ID_Ingredient)
);

```


## Résumé

La création du MPD pour PostgreSQL va au-delà de la simple conversion des entités du MLD en tables, impliquant une optimisation spécifique à la base de données et une application approfondie des principes d'intégrité fonctionnelle et physique. Cela inclut l'utilisation de types de données avancés, la mise en place de contraintes et d'index pour améliorer l'intégrité et les performances des données, et l'adaptation aux fonctionnalités uniques de PostgreSQL. L'exemple de la pizzeria sert de cas pratique pour illustrer la mise en œuvre de ces concepts dans une base de données relationnelle robuste et performante.
